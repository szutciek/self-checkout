(()=>{"use strict";var e,t,i,n,s={934:(e,t,i)=>{i.d(t,{Z:()=>L});const n="http://192.168.0.237:4000",s="http://192.168.0.237:4000/api",r={languages:{en:{full:"English",short:"EN",flag:"🇺🇸"},pl:{full:"Polski",short:"PL",flag:"🇵🇱"}},en:{start:"Touch to start",main:{filters:{popular:{title:"Popular",second:"Quickly buy the most popular items",icon:"🤩"},meals:{title:"Meals",second:"Warm meals for lunch",icon:"🍽️"},salads:{title:"Salads",second:"Fresh and healthy",icon:"🥗"},hotdrinks:{title:"Hot drinks",second:"Hot drinks for cold days",icon:"☕"},desserts:{title:"Desserts",second:"Sweet and delicious",icon:"🍰"},sweets:{title:"Sweets",second:"Sweet and delicious",icon:"🍬"},drinks:{title:"Drinks",second:"Cold drinks for hot days",icon:"🥤"}},properties:{lactose:{name:"Lactose",icon:"🥛"},meat:{name:"W/ Meat",icon:"🍖"},vegetarian:{name:"Vegetarian",icon:"🥦"},cold:{name:"Cold",icon:"❄️"},sweet:{name:"Sweet",icon:"🍬"},spicy:{name:"Spicy",icon:"🌶️"}},nutrition:{energy:{name:"Energy"},calories:{name:"Calories"},fats:{name:"Fats"},sugar:{name:"Sugar"},salt:{name:"Salt"},proteins:{name:"Proteins"}}},items:{starting:"starting at"},ui:{clickToLogin:"Click to login",cancelOrder:"&times;&nbsp; Cancel Order",showSummary:"Show Summary &nbsp;&uarr;",selectSize:"Select size",ingredients:"Ingredients",confirmAddToCart:"&check; Add to cart",addItemToCartSpecific:["&check; Add","to cart"],cancelItem:"&times; Close",learnMore:"Read more on device &rarr;",instructionsCode:'<h2>How to log in using this QR Code?</h2><ul><li>1. Scan the code with your phone.</li><li>2. Log into your account.</li><li>3. Click the "Authorize Station" button.</li></ul>',useAccountData:"Use account details to log in",itemsList:'<div class="item labels"><p>ITEM</p><div></div><p>QUANTITY</p></div>',backToMenu:"&darr;&nbsp; Back to menu",completeOrder:"&check;&nbsp; Confirm & Charge Account",summary:{title:"Summary",second:"Edit the list of products you have selected and complete the process.",total:"TOTAL"},closeServerMessage:"Close"}},pl:{start:"Dotknij, aby rozpocząć",main:{filters:{popular:{title:"Popularne",second:"Najczęściej kupowane produkty",icon:"🤩"},meals:{title:"Posiłki",second:"Ciepłe posiłki obiadowe",icon:"🍽️"},salads:{title:"Sałatki",second:"Zdrowe i świerze",icon:"🥗"},hotdrinks:{title:"Ciepłe napoje",second:"Ciepłe napoje na zimne dni",icon:"☕"},desserts:{title:"Desery",second:"Słodkie i pyszne",icon:"🍰"},sweets:{title:"Słodycze",second:"Słodkie i pyszne",icon:"🍬"},drinks:{title:"Napoje",second:"Zimne napoje na gorące dni",icon:"🥤"}},properties:{lactose:{name:"Laktoza",icon:"🥛"},meat:{name:"Mięsne",icon:"🍖"},vegetarian:{name:"Wegetariańskie",icon:"🥦"},cold:{name:"Zimne",icon:"❄️"},sweet:{name:"Słodkie",icon:"🍬"},spicy:{name:"Ostre",icon:"🌶️"}},nutrition:{energy:{name:"Energia"},calories:{name:"Kalorie"},fats:{name:"Tłuszcze"},sugar:{name:"Cukry"},salt:{name:"Sól"},proteins:{name:"Białka"}}},items:{starting:"zaczyna się od"},ui:{clickToLogin:"Kliknij, aby się zalogować",cancelOrder:"&times;&nbsp; Anuluj zamówienie",showSummary:"Pokaż podsumowanie &nbsp;&uarr;",selectSize:"Wybierz rozmiar",ingredients:"Składniki",confirmAddToCart:"&check; Dodaj do koszyka",addItemToCartSpecific:["&check; Dodaj","do koszyka"],cancelItem:"&times; Zamknij",learnMore:"Dowiedz się więcej na urządz. &rarr;",instructionsCode:'<h2>Jak się zalogować przy użyciu Kodu QR?</h2><ul><li>1. Zaskanuj kod telefonem.</li><li>2. Zaloguj się do swojego konta.</li><li>3. Kliknij przycisk "Authorize Station".</li></ul>',useAccountData:"Użyj danych konta do zalogowania się",itemsList:'<div class="item labels"><p>PRZEDMIOT</p><div></div><p>ILOŚĆ</p></div>',backToMenu:"&darr;&nbsp; Wróć do menu",completeOrder:"&check;&nbsp; Potwierdź & obciąż konto",summary:{title:"Podsumowanie",second:"Edytuj listę produktów, które wybrałeś i zakończ proces zamawiania.",total:"SUMA"},closeServerMessage:"Zamknij"}}};class o{#e={};constructor(e,t,i){if(this.controller=i,!e)throw new Error("Can't create menu - missing menu data");this.ingredients=t,this.prepareMenu(e)}prepareMenu(e){this.controller.supportedLanguages.forEach((t=>{this.#e[t]=this.replaceFieldsData(e[t],t)}))}replaceFieldsData(e,t){return e.map((e=>(e.ingredients=e.ingredients.map((e=>this.ingredients[t][e])),e.properties=e.properties.map((e=>r[t].main.properties[e])),e.nutrition=Object.entries(e.nutrition).map((([e,i])=>{const n=r[t].main.nutrition[e];return n.value=i,n})),e)))}getProductById(e,t=!1){let i=this.#e[this.lang].find((t=>t.id===e));if(i)i=JSON.parse(JSON.stringify(i));else{if(!1===t)return null;let n=null;if(this.supportedLanguages.forEach((t=>{n||(i=JSON.parse(JSON.stringify(this.#e[t].find((t=>t.id===e)))),i&&(n=t))})),!n)return null;i=JSON.parse(JSON.stringify(i)),i.name=`[${n}] ${i.name}`}return i}get currentMenu(){return this.#e[this.lang]}updateMenuItems(e){this.#e=e}get allItems(){return this.#e}get lang(){return this.controller.lang}get supportedLanguages(){return this.controller.supportedLanguages}}class a{#t=[];constructor(e){this.controller=e}addItem(e,t=1){if(!e.id)throw new Error("Can't add item to cart - missing id");if(!e.size)throw new Error("Can't add item to cart - missing size");const i=this.findItem(e.id,e.size);if(i)this.editItemQuantity(i.id,i.size,i.quantity+t),this.controller.cartUpdated();else{const i={id:e.id,size:e.size,quantity:t};this.#t.push(i),this.controller.cartUpdated()}}findItem(e,t){return this.#t.find((i=>i.id===e&&i.size===t))||null}editItemQuantity(e,t,i){if(!e||!t)return;const n=this.findItem(e,t);return n?(this.controller.cartUpdated(),i<=0?this.removeItem(e):(n.quantity=i,JSON.parse(JSON.stringify(n)))):void 0}incrementItemQuantity(e,t){if(!e||!t)return;const i=this.findItem(e,t);i&&(i.quantity++,this.controller.cartUpdated())}reduceItemQuantity(e,t){if(!e||!t)return;const i=this.findItem(e,t);i&&(i.quantity--,i.quantity<=0?this.removeItem(e,t):this.controller.cartUpdated())}removeItem(e,t){e&&t&&(this.#t=this.#t.filter((i=>i.id!==e||i.size!==t)),this.controller.cartUpdated())}get checkoutData(){return this.#t}get items(){return this.#t.map((e=>{const t=this.controller.menu.getProductById(e.id,!0);if(!t)return;const i={};return i.product=t,i.quantity=e.quantity,i.size=e.size,i.price=t.sizes[e.size].price,i}))}get numberOfItems(){return this.#t.length}get total(){return this.items.reduce(((e,t)=>e+t.price),0)}}class l{element=void 0;constructor(e){try{if(this.elementId=e,!this.elementId)throw new Error("ElementId not defined.");if(this.element=document.getElementById(e),!this.element)throw new Error("Element not found.");this.handleCreationGeneral()}catch(t){console.warn(`Couldn't create window ${e}: ${t.message}`)}}handleCreationGeneral(){this.element.style.opacity=0,this.element.style.pointerEvents="none",this.element.classList.remove("hidden")}handleLanguageChange(){}handleUserChange(){}handleOutsideClick(){}forceHide(){this.element.style.display="none"}}const c=[{backgroundImage:"radial-gradient(#264ea5 50%, #2b5eca 50%)",backgroundSize:"0% 0%",transform:"scale(1)",backgroundColor:"#2b5eca",offset:0},{backgroundImage:"radial-gradient(#264ea5 50%, #2b5eca 50%)",backgroundSize:"600px 600px",transform:"scale(0.95)",backgroundColor:"#2b5eca",offset:.5},{backgroundImage:"none",backgroundSize:"0% 0%",backgroundColor:"#264ea5",transform:"scale(0.95)",offset:.50001},{backgroundImage:"none",backgroundColor:"#2b5eca",transform:"scale(1)",offset:1}],h={duration:400},d=[{backgroundImage:"radial-gradient(#c0c0c0 50%, #f1f1f1 50%)",backgroundSize:"0% 0%",transform:"scale(1)",backgroundColor:"#f1f1f1",border:"var(--whiteItemBorder)",color:"#181818",offset:0},{backgroundImage:"radial-gradient(#c0c0c0 50%, #f1f1f1 50%)",backgroundSize:"200px 200px",transform:"scale(0.95)",backgroundColor:"#f1f1f1",color:"#181818",offset:.5},{backgroundImage:"none",backgroundSize:"0% 0%",border:"1px solid transparent",backgroundColor:"#c0c0c0",transform:"scale(0.95)",offset:.50001},{backgroundColor:"#181818",offset:.9},{backgroundImage:"none",backgroundColor:"#181818",color:"#fff",transform:"scale(1)",offset:1}],u={duration:300},m=[{backgroundImage:"radial-gradient(#ececec 50%, #ffffff 50%)",backgroundSize:"0% 0%",transform:"scale(1)",offset:0},{backgroundSize:"600px 600px",transform:"scale(0.95)",backgroundColor:"#fff",offset:.5},{backgroundSize:"0% 0%",backgroundColor:"#efefef",transform:"scale(0.95)",offset:.5001},{backgroundColor:"#efefef",transform:"scale(0.95)",offset:.6},{backgroundColor:"#fff",transform:"scale(1)",offset:1}],p=JSON.parse(JSON.stringify(m).replace("600px 600px","1200px 1200px")),g={duration:400},f=[{transform:"scale(1)"},{transform:"scale(0.9)",border:"1px solid #d66"},{transform:"scale(1)"}];class y extends l{prepared=!1;duration=800;allowFilterChange=!0;currentFilter="popular";constructor(e,t){super(e),this.controller=t,this.handleCreation()}handleCreation(){this.addEventListeners()}addEventListeners(){this.element.addEventListener("click",this.handleClick)}handleOutsideClick(e){}handleClick=e=>{e.target.closest(".menu")&&this.handleMenuClick(e),this.controller.handleClick(e)};handleMenuClick(e){if(!e.target.closest(".item")?.dataset.id)return;if(!1===this.controller.allowPopup)return;if(this.controller.itemPopup.inTransition)return;const t=e.target.closest(".item"),i=this.findMenuItemById(t.dataset.id);let n=!0;const s=t.querySelector("img").getBoundingClientRect();s.top<166&&(n=!1),this.controller.showItem(i,t,n),n&&this.handleImageZoom(t,s),this.handleItemAnimation(t)}handleItemAnimation(e){const t=m,i=g;e.animate(t,i)}handleImageZoom(e,t){const i=e.querySelector("img");if(!i)return;t||(t=i.getBoundingClientRect());const n=this.controller.itemPopup.imageZoomPosition,s=i.cloneNode(!1);i.style.transition="opacity 0s",i.style.opacity=0,s.classList.add("menuItemPreview"),s.style.position="absolute",s.style.top=`${t.top}px`,s.style.left=`${t.left}px`,s.style.width=`${t.width}px`,s.style.zIndex=0,document.body.appendChild(s);const r=this.controller.itemPopup.animationDuration,o=this.controller.itemPopup.animationDelay,a=[{top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,offset:0},{top:`${n.top}px`,left:`${n.left}px`,width:`${n.width}px`,offset:1}],l={duration:r,iterations:1,fill:"forwards",easing:"cubic-bezier(.33,1.24,.57,1)"};setTimeout((()=>{s.style.zIndex=1e3,s.animate(a,l),setTimeout((()=>{document.body.removeChild(s),i.style.transition="opacity 0.5s",i.style.opacity=1}),r)}),o)}findMenuItemById(e){return this.currentMenu.find((t=>t.id===e))}updateMenu(e){if(!e)return;this.currentMenu=e,this.prepared=!0;const t=e.filter((e=>e.types.includes(this.currentFilter)));this.displayMenu(t)}displayMenu(e=[]){const t=this.element.querySelector(".gridMenu");t.innerHTML="",e.forEach((e=>{let i=["",1/0];Object.values(e.sizes).forEach((e=>{e.price<i[1]&&(i=[e.name,e.price])}));const n=document.createElement("div");n.classList.add("item"),n.classList.add("itemClickAnimation"),n.dataset.id=e.id,n.innerHTML=`\n        <img\n          src="${e.image}"\n          alt="${e.name}"\n          class="menuItemPreview"\n        />\n        <div class="info">\n          <p class="name">${e.name}</p>\n          <p class="properties">${e.properties.map((e=>e.icon)).join(" ")}</p>\n          <p class="starting">${i[0]} ${r[this.controller.lang].items.starting}</p>\n          <p class="price">${i[1]/100}zł</p>\n        </div>\n      `,t.appendChild(n)}))}show(){this.element.style.pointerEvents="auto",this.element.style.opacity=1,this.insertContent(this.controller.lang)}insertContent(e){this.insertFilters(e),this.insertHead(e),this.insertLanguages()}insertFilters(e=this.controller.lang){const t=this.element.querySelector(".filtersList");t.innerHTML="",Object.entries(r[e].main.filters).forEach((([e,i])=>{const n=document.createElement("li");n.dataset.filter=e,this.currentFilter===e&&n.classList.add("active"),n.classList.add("itemClickAnimation"),n.innerHTML=`\n        <p>${i.title}</p>\n      `,n.addEventListener("click",this.handleFilterClick),t.appendChild(n)}))}insertHead(e=this.controller.lang){const t=r[e].main.filters[this.currentFilter];this.element.querySelector(".head .info").innerHTML=`\n      <h1>${t.title}</h1>\n      <p>${t.second}</p>\n    `}insertLanguages(){const e=this.element.querySelector(".head .languages");e.innerHTML="",Object.values(r.languages).forEach((t=>{const i=document.createElement("li");t.short.toLowerCase()===this.controller.lang&&i.classList.add("active"),i.dataset.lang=t.short.toLowerCase(),i.innerHTML=`<p>${t.short.toUpperCase()}</p>`,i.addEventListener("click",this.handleLanguageClick),e.appendChild(i)}))}handleFilterClick=e=>{if(!1===this.allowFilterChange)return;const t=e.target.closest("li"),i=t.dataset.filter;if(i===this.currentFilter)return;this.allowFilterChange=!1,t.animate(d,u),e.target.closest("ul").querySelectorAll("li").forEach((e=>{e.classList.remove("active"),e.dataset.filter===i&&setTimeout((()=>{e.classList.add("active"),this.allowFilterChange=!0}),u.duration-20)})),this.currentFilter=i,this.insertHead();const n=this.currentMenu.filter((e=>e.types.includes(this.currentFilter)));this.displayMenu(n)};handleLanguageClick=e=>{const t=e.target.closest("li").dataset.lang;t&&(this.controller.lang=t,this.insertLanguages())};handleLanguageChange(){this.insertContent(this.controller.lang)}}class C extends l{duration=600;delay=0;clamps=["px:150","px:330","vh:85","vh:100"];defaultClamp="px:150";hideDuration=400;userDraggable=!0;elementHeight=0;previousTouch=0;movementDirection=0;moving=!1;#i=!1;#n=!1;#s=0;#r=2;#o=!1;animation=[{pointerEvents:"none",transform:"translateY(100%)",opacity:1},{pointerEvents:"auto",transform:"translateY(0)",opacity:1}];options={iterations:1,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"};constructor(e){super(e),this.elementHeight=this.element.getBoundingClientRect().height,this.addEventListeners()}addEventListeners(){this.element.addEventListener("touchstart",this.handleTouch),this.element.addEventListener("touchmove",this.handleTouch),this.element.addEventListener("touchend",this.handleTouch),this.element.addEventListener("touchcancel",this.handleTouch),this.element.addEventListener("click",this.handleParentClick)}handleTouch=e=>{"touchstart"===e.type&&this.handleParentTouchStart(e),"touchmove"===e.type&&this.handleParentTouchMove(e),"touchend"===e.type&&this.handleParentTouchEnd(e),"touchcancel"===e.type&&this.handleParentTouchEnd(e)};handleParentClick=e=>{this.handleClick(e)};handleClick(){}handleParentTouchStart(e){this.handleTouchStart(e),!1!==this.userDraggable&&e.target.closest(".move")&&this.handleStartMovement(e)}handleTouchStart(){}handleParentTouchMove(e){!0===this.moving&&this.handleMovement(e),this.handleTouchMove(e)}handleTouchMove(){}handleParentTouchEnd(e){!0===this.moving&&this.handleEndMovement(e),this.handleTouchEnd(e)}handleTouchEnd(){}handleStartMovement(e){e.target.closest(".move")&&!1===this.#n&&!1===this.moving&&(e.preventDefault(),this.previousTouch=e.targetTouches[0].clientY,this.moving=!0)}handleMovement(e){if(!1===this.moving)return;e.preventDefault();const t=e.targetTouches[0];this.movementDirection=-Math.sign(t.clientY-this.previousTouch),t.clientY-this.previousTouch>50&&(this.movementDirection=-2),t.clientY-this.previousTouch<-50&&(this.movementDirection=2),this.resize(t.clientY-this.previousTouch),this.previousTouch=e.targetTouches[0].clientY}handleEndMovement(e){!1!==this.moving&&(e.preventDefault(),this.clampHeight(this.movementDirection),this.movementDirection=0,this.moving=!1)}clampHeight(e){if(0===e)return;if(-2===e)return this.hide();2===e&&(this.currentClamp=this.clamps.length-1);const t=this.determineClamp(e);if(-1===t)return this.hide();this.currentClamp=t,this.smoothResize()}determineClamp(e){const t=this.clamps.map((e=>this.translateChangeElementHeight(e))).map((e=>e-this.elementHeight));if(-1===e){const e=t.filter((e=>e<0)).length-1;return e===t.length?t.length-1:e<0?-1:t.filter((e=>e<0)).length-1}if(1===e){const e=t.length-t.filter((e=>e>0)).length;return e===t.length?t.length-1:e<0?-1:t.length-t.filter((e=>e>0)).length}return this.currentClamp}translateChangeElementHeight(e){if(!e)return this.elementHeight;const[t,i]=e.split(":");return t&&i?"px"===t?Number(i):"vh"===t?Number(window.innerHeight*i/100):void 0:this.elementHeight}resize(e=0){this.elementHeight-=e,this.element.style.height=`${this.elementHeight}px`}smoothResize(){this.element.style.transition="0.5s cubic-bezier(0.16, 1, 0.3, 1)",this.resize(),this.#n=!0,setTimeout((()=>{this.element.style.transition="0s",this.#n=!1}),300)}show(e=!1){!0!==this.#i&&!0!==this.#n&&(this.#n=!0,this.#i=!0,this.showBase(e),this.showSpecific(e))}showSpecific(){}showBase(e){this.currentClamp=this.clamps.indexOf(this.defaultClamp),this.elementHeight=this.translateChangeElementHeight(this.defaultClamp),this.resize(),this.element.animate(this.animation,{...this.options,duration:this.duration,delay:this.delay});let t=this.duration;!0===e&&(t+=this.delay),setTimeout((()=>{this.resize(),this.#n=!1,this.controller.popupShown(this.elementId)}),t)}hide(){!1!==this.#i&&!0!==this.#n&&(this.#n=!0,"function"==typeof this.hideSpecific?this.hideSpecific().then((()=>this.hideBase())):this.hideBase())}hideBase(){this.element.animate([...this.animation].reverse(),{...this.options,delay:0,duration:this.hideDuration}),setTimeout((()=>{this.element.style.pointerEvents="none",this.element.style.opacity=0,this.#n=!1,this.#i=!1,this.controller.popupHidden(this.elementId)}),this.hideDuration)}outsideChangeClamp(e){this.currentClamp=e,this.smoothResize()}clampChangeFunction(){}get currentClamp(){return this.#r}set currentClamp(e){const t=this.translateChangeElementHeight(this.clamps[e]);this.#r=e,this.elementHeight=t,this.clampChangeFunction()}openDelayChangeFunction(){}get openDelay(){return this.#s}set openDelay(e){this.#s=e,this.openDelayChangeFunction()}get animationDuration(){return this.duration}get animationDelay(){return this.delay+this.#s}get visible(){return this.#i||this.#o}set visible(e){console.warn("Don't set visible directly, use show() and hide() instead!"),this.#i=e}get inTransition(){return this.#n}get reopening(){return this.#o}set reopening(e){this.#o=e}}class w extends C{clamps=["px:180","px:330","px:900","vh:100"];defaultClamp="px:900";duration=600;delay=150;hideDuration=500;currentProduct={};#a={top:0,left:0,width:0};allowSizeChange=!0;selectedSize="";constructor(e,t){super(e),this.controller=t,this.handleCreation()}handleCreation(){window.addEventListener("resize",(()=>this.calculateImageZoomPosition())),this.calculateImageZoomPosition()}calculateImageZoomPosition(){const e=this.translateChangeElementHeight(this.defaultClamp),t=window.innerHeight-(e>window.innerHeight?window.innerHeight:e)+50,i=16+(window.innerWidth>=800?(window.innerWidth-800)/2:0),n=window.innerWidth>=800?368:(window.innerWidth-64)/2;this.#a={top:t,left:i,width:n}}handleOutsideClick(e){if(!this.inTransition&&e.target.closest(".item")?.dataset.id!==this.currentProduct.id){if(0===this.currentClamp)return this.hide();this.currentClamp=0,this.smoothResize()}}handleClick(e){return e.target.closest(".sizeOption")?this.handleSizeSelection(e):e.target.closest(".confirmAddButton")?this.handleAddToCart():e.target.closest(".cancelItem")?this.hide():e.target.closest(".redirectUser")?this.redirectUser(e):void 0}resetData(){this.currentProduct={},this.selectedSize=""}redirectUser(e){const t=e.target.closest(".redirectUser").dataset.url;t&&this.controller.redirectUser(t)}insertContent(e,t=void 0){const i=this.element.querySelector("#itemPopupDescription");if(!i)return;let n;i.innerHTML="",t?n=t.querySelector("img").cloneNode(!1):(n=document.createElement("img"),n.src=e.image,n.alt=e.name,n.style.width="100%",n.classList.add("menuItemPreview"));const s=this.createDetails(e);i.insertAdjacentElement("afterbegin",n),i.insertAdjacentElement("beforeend",s);const r=this.element.querySelector("#itemPopupSizeMenu");if(!r)return;r.innerHTML="";const o=this.createSizeMenu(e);r.innerHTML=o;const a=this.element.querySelector("#itemPopupIngredients");if(!a)return;a.innerHTML="";const l=this.createIngredients(e);a.innerHTML=l}createIngredients(e){return`\n          ${e.ingredients.map((e=>`<li>\n                <p class="info"><span>${e.icon}</span>&nbsp;${e.name}</p>\n                <div class="benefits">\n                  <p>${e.info}</p>\n                  <button class="redirectUser" data-url="${e.learnUrl}">${r[this.controller.lang].ui.learnMore}</button>\n                </div>\n              </li>\n              `)).join("")}\n      `}createSizeMenu(e){return Object.entries(e.sizes).map((([e,t])=>`\n    <li class="itemClickAnimation sizeOption" data-size="${e}">\n      <p class="name">${t.name}</p>\n      <p class="size">${t.size}</p>\n      <p class="price">${t.price/100}zł</p>\n    </li>\n  `)).join("")}handleSizeSelection(e){!1!==this.allowSizeChange&&(this.allowSizeChange=!1,this.selectedSize=e.target.closest(".sizeOption").dataset.size,this.element.querySelectorAll(".sizeOption").forEach((e=>{e.dataset.size===this.selectedSize?(e.animate(d,u),setTimeout((()=>{e.classList.add("active"),this.allowSizeChange=!0}),u.duration-20)):e.classList.remove("active")})),this.checkIfCompleted())}createDetails(e){const t=document.createElement("div");return t.classList.add("details"),t.innerHTML=`\n    <h1>${e.name}</h1>\n    <div class="section properties">\n      <ul>\n        ${e.properties.map((e=>`<li>${e.icon} ${e.name}</li>`)).join("")}\n      </ul>\n    </div>\n    <div class="section nutrition">\n      <ul>\n        ${e.nutrition.map((e=>`<li><p class="name">${e.name}</p><p class="value">${e.value}</p></li>`)).join("")}\n      </ul>\n      <p class="info">* ${e.nutritionInfo}</p>\n    </div>\n    `,t}checkIfCompleted(){let e=!0;return this.selectedSize||(e=!1,this.attractAttentionSize()),e?this.unlockAddToCartButton():this.lockAddToCartButton(),e}unlockAddToCartButton(){const e=this.element.querySelectorAll(".confirmAddButton"),t=this.currentProduct.sizes[this.selectedSize].name,i=r[this.controller.lang].ui.addItemToCartSpecific;e.forEach((e=>{e.innerHTML=`${i[0]} ${t} ${this.currentProduct.name.split(" ")[0]} ${i[1]}`,e.classList.remove("locked")}))}lockAddToCartButton(){this.element.querySelectorAll(".confirmAddButton").forEach((e=>{e.innerHTML=r[this.controller.lang].ui.confirmAddToCart,e.classList.add("locked")}))}attractAttentionSize(){this.element.querySelectorAll(".sizeOption").forEach(((e,t)=>{e.animate(f,{delay:100*t,duration:500,easing:"ease-in-out"})}))}handleAddToCart(){this.checkIfCompleted()&&(this.controller.cart.addItem({id:this.currentProduct.id,size:this.selectedSize}),this.element.querySelectorAll(".confirmAddButton").forEach((e=>{e.animate(c,h),setTimeout((()=>{this.hide()}),h.duration)})))}showItem(e,t=void 0,i=!1){this.resetData(),this.checkIfCompleted(),!0===this.visible?(this.reopening=!0,this.openDelay=this.hideDuration,this.hide(),setTimeout((()=>{this.insertContent(e,t),this.show(t&&i),this.openDelay=0}),this.openDelay)):(this.openDelay=0,this.insertContent(e,t),this.show(t&&i)),this.currentProduct=e}insertUIContent(){const e=this.element.querySelector("#selectSizeText"),t=this.element.querySelector("#ingredients");e.innerText=r[this.controller.lang].ui.selectSize,t.innerText=r[this.controller.lang].ui.ingredients;const i=this.element.querySelector(".confirmAddButton"),n=this.element.querySelector(".cancelItem");i.innerHTML=r[this.controller.lang].ui.confirmAddToCart,n.innerHTML=r[this.controller.lang].ui.cancelItem}showSpecific(e){this.element.querySelector(".content").scrollTo(0,0),this.insertUIContent();const t=this.element.querySelector("img");t.style.transition="0s",e&&(t.style.opacity=0),setTimeout((()=>{t.style.opacity=1,this.reopening=!1}),e?this.duration+this.delay:this.duration)}handleLanguageChange(){this.hide(),this.insertUIContent()}toggleFloatingButton(){const e=this.element.querySelector(".floatingButton");this.currentClamp>=2?e.style.transform="translateY(0)":e.style.transform="translateY(100%)"}clampChangeFunction(){this.toggleFloatingButton()}imageZoomPositionChangeFunction(){}get imageZoomPosition(){return this.#a}}class v extends C{clamps=["vh:50"];defaultClamp="vh:50";delay=0;userDraggable=!1;#l=!1;dots="";constructor(e,t){super(e),this.controller=t}handleOutsideClick(){!0!==this.#l&&this.hide()}handleClick(e){e.target.closest(".closePopup")&&this.handleCloseClick()}handleCloseClick(){this.element.querySelector(".closePopup").animate(c,h),setTimeout((()=>this.hide()),h.duration+100)}showSuccess(e){!0===this.#l&&this.hideMessage(),this.hideAllDivs(),this.element.querySelector("#message").classList.add("success"),this.element.querySelector(".success").classList.remove("hidden"),this.updateMessageDisplay(e),this.show()}showLoading(e){!0===this.#l&&this.hideMessage(),this.hideAllDivs(),this.element.querySelector("#message").classList.add("loading"),this.element.querySelector(".loading").classList.remove("hidden"),this.message=e,this.updateLoadingMessageDisplay(),this.interval=setInterval((()=>this.updateLoadingMessageDisplay()),200),this.#l=!0,this.show()}showError(e){!0===this.#l&&this.hideMessage(),this.hideAllDivs(),this.element.querySelector("#message").classList.add("error"),this.element.querySelector(".error").classList.remove("hidden"),this.updateMessageDisplay(e),this.show()}hideAllDivs(){this.element.querySelector(".loading").classList.add("hidden"),this.element.querySelector(".success").classList.add("hidden"),this.element.querySelector(".error").classList.add("hidden");const e=this.element.querySelector("#message");e.classList.remove("error"),e.classList.remove("success"),e.classList.remove("loading"),this.evaluateButtonVisibility()}updateMessageDisplay(e){this.element.querySelector("#message").innerText=e}showSpecific(){this.evaluateButtonVisibility()}evaluateButtonVisibility(){if(!0===this.#l)return this.hideCloseButton();this.showCloseButton()}hideCloseButton(){this.element.querySelector(".floatingButton").style.transform="translateY(100%)"}showCloseButton(){this.element.querySelector(".floatingButton").style.transform="translateY(0)"}updateLoadingMessageDisplay(){const e=this.element.querySelector("#message");0===this.dots.length?this.dots=".":1===this.dots.length?this.dots="..":2===this.dots.length?this.dots="...":this.dots="",e.innerHTML=this.message+this.dots.padEnd(3," ")}hideMessage(){clearInterval(this.interval),this.message="",this.dots="",this.#l=!1}handleLanguageChange(){this.insertButtonContent()}hideSpecific(){return new Promise((e=>{this.hideMessage(),e()}))}insertButtonContent(){this.element.querySelector(".closePopup").innerText=r[this.controller.lang].ui.closeServerMessage}get loading(){return this.#l}}class k extends C{clamps=["px:387","vh:100"];defaultClamp="px:387";delay=200;userDraggable=!1;constructor(e,t){super(e),this.controller=t}handleOutsideClick(){this.visible&&!this.inTransition&&this.hide()}showSpecific(){this.insertContent()}handleClick(e){}insertUIContent(){const e=this.element.querySelector(".useAccountData"),t=this.element.querySelector(".instructionsCode");e.innerText=r[this.controller.lang].ui.useAccountData,t.innerHTML=r[this.controller.lang].ui.instructionsCode}insertContent(){this.insertUIContent();const e=this.element.querySelector(".codeBackground");e.innerHTML=`<a href="${n}/authorize?sessionId=${this.controller.sessionId}" target="_blank">temp. link</a>`;const t=document.createElement("canvas");new QRious({element:t,backgroundAlpha:0,foreground:"#181818",foregroundAlpha:1,level:"H",size:500,value:`${n}/authorize?sessionId=${this.controller.sessionId}`}),e.appendChild(t)}}class S extends C{clamps=["px:180","vh:100"];defaultClamp="px:180";duration=300;delay=0;userDraggable=!1;closeSummaryDuration=300;constructor(e,t){super(e),this.controller=t}handleOutsideClick(e){this.inTransition||(this.currentClamp=0,this.smoothResize())}handleClick(e){return e.target.closest(".cancelOrder")?this.controller.cancelOrder():e.target.closest(".logUserIn")?this.loginClicked():e.target.closest(".showSummary")?this.summaryButtonClick():e.target.closest(".backToMenu")?this.backToMenuButtonClick():e.target.closest(".confirmCheckout")?this.confirmCheckoutButtonClick():e.target.closest(".item")?this.handleItemClick(e):void 0}loginClicked(){this.selectLogin(),this.controller.showLogin(),setTimeout((()=>this.hide()),200)}showSpecific(){this.insertContent(),this.deselectLogin(),this.checkIfCompleted(!1),this.showBrief(),this.hideSummary()}handleUserChange(e){this.checkIfCompleted(),this.insertUserContent(),this.selectLogin(),setTimeout((()=>this.deselectLogin()),1e3)}checkIfCompleted(e=!0){let t=!0;return this.controller.user||(t=!1,!0===e&&this.attractAttentionLogin()),!0===t?this.unlockCheckoutButton():this.lockCheckoutButton(),t}attractAttentionLogin(){this.element.querySelector(".logUserIn").animate(f,{duration:500,easing:"ease-in-out"})}unlockCheckoutButton(){this.element.querySelector(".showSummary").classList.remove("locked")}lockCheckoutButton(){this.element.querySelector(".showSummary").classList.add("locked")}selectLogin(){const e=this.element.querySelector(".logUserIn");e.style.pointerEvents="none",e.animate(d,u),setTimeout((()=>{e.classList.add("active")}),u.duration/2)}deselectLogin(){const e=this.element.querySelector(".logUserIn");e.classList.remove("active"),e.style.pointerEvents="auto"}summaryButtonClick(){this.checkIfCompleted()&&(this.element.querySelector(".showSummary").animate(c,h),setTimeout((()=>{this.showSummary(),this.hideBrief()}),h.duration-50))}confirmCheckoutButtonClick(){this.element.querySelector(".confirmCheckout").animate(c,h),setTimeout((()=>{this.controller.confirmOrder(),this.hide()}),h.duration-50)}backToMenuButtonClick(){this.hideSummary(),this.showBrief()}showSummary(){this.currentClamp=1;const e=this.element.querySelector(".summary");e.classList.remove("hidden"),e.style.maxHeight=`${this.translateChangeElementHeight(this.clamps[1])}px`,this.showSummaryButtons(),this.smoothResize()}hideSummary(){this.currentClamp=0;const e=this.element.querySelector(".summary");e.classList.add("hidden"),e.style.maxHeight="0px",this.hideSummaryButtons(),this.smoothResize()}showSummaryButtons(){this.element.querySelector(".lastAction").style.transform="translateY(0%)"}hideSummaryButtons(){this.element.querySelector(".lastAction").style.transform="translateY(100%)"}showBrief(){this.currentClamp=0;const e=this.element.querySelector(".brief");e.classList.remove("hidden"),e.style.maxHeight=`${this.translateChangeElementHeight(this.clamps[0])}px`,this.smoothResize()}hideSpecific(){return new Promise((e=>{1===this.currentClamp?(this.hideSummary(),this.showBrief(),setTimeout((()=>{e()}),this.closeSummaryDuration)):e()}))}hideBrief(){this.currentClamp=1;const e=this.element.querySelector(".brief");e.classList.add("hidden"),e.style.maxHeight="0px",this.smoothResize()}insertContent(){this.insertCartContent(),this.insertUserContent(),this.insertButtonContent(),this.insertSummaryContent(),this.insertSummaryTitleContent(),this.insertSummaryButtonsContent()}updateCart(){this.insertContent()}insertButtonContent(){const e=this.element.querySelector(".showSummary"),t=this.element.querySelector(".cancelOrder");e.innerHTML=r[this.controller.lang].ui.showSummary,t.innerHTML=r[this.controller.lang].ui.cancelOrder}insertUserContent(){const e=this.element.querySelector(".loginText");null!=this.controller.user?e.innerText=this.controller.user.name:e.innerText=r[this.controller.lang].ui.clickToLogin}insertSummaryContent(){const e=this.element.querySelector("#itemList");let t=r[this.controller.lang].ui.itemsList;t+=this.controller.cart.items.map((e=>`\n        <div class="item itemClickAnimation" data-id="${e.product.id}" data-size="${e.size}">\n          <div class="preview">\n            <img\n              src="${e.product.image}"\n              alt="${e.product.name}"\n            />\n          </div>\n          <div class="info">\n            <h2>${e.product.name}</h2>\n            <p class="price">${e.price/100}zł</p>\n            <p class="size"><span>${e.product.sizes[e.size].name}</span>${e.product.sizes[e.size].size}</p>\n          </div>\n          <div class="quantity">\n            <div class="adjust flexVert"><button class="add">&plus;</button><h2>${e.quantity}x</h2><button class="subtract">&minus;</button></div>\n            <button class="delete">&times;</button>\n          </div>\n        </div>\n        `)).join(""),e.innerHTML=t}insertSummaryTitleContent(){const e=this.element.querySelector(".summaryHead h1"),t=this.element.querySelector(".summaryHead p"),i=this.element.querySelector(".total .texts p");e.innerText=r[this.controller.lang].ui.summary.title,t.innerText=r[this.controller.lang].ui.summary.second,i.innerText=r[this.controller.lang].ui.summary.total}insertSummaryButtonsContent(){const e=this.element.querySelector(".confirmCheckout"),t=this.element.querySelector(".backToMenu");e.innerHTML=r[this.controller.lang].ui.completeOrder,t.innerHTML=r[this.controller.lang].ui.backToMenu}insertCartContent(){const e=this.controller.cart.total;this.element.querySelectorAll(".cartPrice").forEach((t=>t.innerHTML=Math.round(e)/100+"zł")),this.element.querySelector(".total .itemCount").innerHTML=`${this.controller.cart.numberOfItems}`}handleLanguageChange(e){this.insertContent()}handleItemClick=e=>{if(e.target.closest(".info"))return e.target.closest(".item").animate(p,g),void setTimeout((()=>{this.hide(),setTimeout((()=>{this.controller.showItem(this.controller.menu.getProductById(e.target.closest(".item").dataset.id))}),this.closeSummaryDuration+100)}),g.duration+100);const t=e.target.closest(".item").dataset.id,i=e.target.closest(".item").dataset.size;return e.target.closest(".add")?this.controller.cart.incrementItemQuantity(t,i):e.target.closest(".subtract")?this.controller.cart.reduceItemQuantity(t,i):e.target.closest(".delete")?this.controller.cart.removeItem(t,i):void 0}}class b extends l{duration=700;constructor(e,t){super(e),this.controller=t,this.handleCreation()}handleCreation(){this.addEventListeners()}addEventListeners(){this.element.addEventListener("click",this.handleClick)}removeEventListeners(){this.element.removeEventListener("click",this.handleClick)}handleClick=e=>{this.controller.allowUnlock&&this.controller.startOrder()};hide(){const e={duration:this.duration,iterations:1,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"};this.element.animate([{transform:"translateY(0%)"},{transform:"translateY(100%)"}],e),setTimeout((()=>{this.element.style.pointerEvents="none",this.element.style.opacity=0}),this.duration)}show(){this.insertContent(this.controller.lang),this.element.style.pointerEvents="auto",this.element.style.opacity=1;const e={duration:this.duration,iterations:1,fill:"forwards",easing:"cubic-bezier(0.16, 1, 0.3, 1)"};this.element.animate([{transform:"translateY(100%)"},{transform:"translateY(0%)"}],e)}insertContent(e=this.controller.lang){this.element.querySelector(".startOrderButton").innerHTML=r[e].start}handleLanguageChange(){this.insertContent(this.controller.lang)}}class L{#c=0;#h="en";#d=null;#u=!1;#e=void 0;#m=void 0;#p=null;#g=void 0;#f=["en","pl"];constructor(){this.mainWindow=new y("mainElement",this),this.itemPopup=new w("itemPopupElement",this),this.serverPopup=new v("serverPopupElement",this),this.loginPopup=new k("loginPopupElement",this),this.checkoutPopup=new S("checkoutPopupElement",this),this.lockWindow=new b("lockElement",this),this.popups=[this.itemPopup,this.checkoutPopup,this.loginPopup,this.serverPopup],this.windows=[...this.popups,this.mainWindow,this.lockWindow]}setup(){return new Promise((async(e,t)=>{try{await this.connectSocket(),this.addSocketListeners(),this.#p=await this.getSessionId();const t=await this.getIngredientInfo(),i=await this.getMenuItems();this.#m=new a(this),this.#e=new o(i,t,this),this.handleChangeLanguage(),this.mainWindow.show(),this.checkoutPopup.show(),this.#u=!0,e()}catch(e){document.body.innerText="Failed to setup client",t(e)}}))}restartStation(){return new Promise((async(e,t)=>{try{this.#u=!1,this.#p=await this.getSessionId(),this.#m=new a(this),this.#c=0,this.#h="en",this.#d=null,this.#u=!0,e()}catch(e){t(e)}}))}async getIngredientInfo(){try{const e=await fetch(`${s}/ingredients`);if(!e.ok)throw new Error("Failed to get ingredient info");const t=await e.json();if(!t)throw new Error("Failed to parse ingredient info");return t.ingredients}catch(e){console.warn(e.message)}}async getMenuItems(){try{const e=await fetch(`${s}/menu`);if(!e.ok)throw new Error("Failed to get menu items");const t=await e.json();if(!t)throw new Error("Failed to parse menu items");return t.menu}catch(e){console.warn(e)}}connectSocket(){return new Promise((async(e,t)=>{try{this.#g=new WebSocket("ws://192.168.0.237:4001"),this.#g.onopen=()=>{this.#g.send(JSON.stringify({type:"registerstation"})),e()}}catch(e){t(e)}}))}getSessionId(){return new Promise((async(e,t)=>{try{const t=i=>{const n=JSON.parse(i.data);"sessionId"===n.type&&(this.#g.removeEventListener("message",t),e(n.id))};this.#g.addEventListener("message",t),this.#g.send(JSON.stringify({type:"assignSessionId"}))}catch(e){t(e)}}))}addSocketListeners(){this.#g.addEventListener("message",this.handleWSMessage)}handleWSMessage=e=>{const t=JSON.parse(e.data);"userAuthorized"===t.type&&(this.user=t.user,this.loginPopup.hide())};showLogin(){!1!==this.allowPopup&&this.loginPopup.show()}showItem(e,t,i){!1!==this.allowPopup&&this.itemPopup.showItem(e,t,i)}cancelOrder(){this.popups.forEach((e=>e.hide())),this.lockWindow.show(),this.restartStation()}popupShown(e){e!==this.checkoutPopup.elementId&&this.checkoutPopup.hide()}popupHidden(e){if(!1===this.allowPopup)return;let t=!0;this.popups.forEach((e=>{!0===e.visible&&(t=!1)})),!0===t&&this.checkoutPopup.show()}getProductById(e,t){this.menu.getProductById(e,t)}updateMenu(){this.mainWindow.updateMenu(this.#e.currentMenu)}startOrder(){0===this.#c&&!0===this.mainWindow.prepared&&(this.#c=1,this.lockWindow.hide())}cartUpdated(){this.checkoutPopup.updateCart()}confirmOrder(){return new Promise((async(e,t)=>{try{const e=this.cart.checkoutData;await this.awaitOrderConfirmation(e),this.serverPopup.showSuccess("Order accepted. Thank you!")}catch(e){this.serverPopup.showError(e)}}))}awaitOrderConfirmation(e){return new Promise((async(t,i)=>{if(this.#g.readyState===WebSocket.CLOSED)return i("Connection to server lost. Please restart station.");const n=e=>{const s=JSON.parse(e.data);"orderAccepted"===s.type&&t(),"orderWarning"===s.type&&i("Server returned warning!"),"orderFailure"===s.type&&i(s.message),this.#g.removeEventListener("message",n)};this.#g.addEventListener("message",n),this.#g.addEventListener("close",(()=>i("Connection to server lost. Please restart station."))),this.serverPopup.showLoading("Processing your order"),this.#g.send(JSON.stringify({type:"order",cart:e}))}))}handleChangeLanguage(){this.updateMenu(),this.windows.forEach((e=>e.handleLanguageChange(this.lang)))}handleClick(e){e.target.closest("#mainElement")||this.mainWindow.handleOutsideClick(e),e.target.closest("#itemPopupElement")||this.itemPopup.handleOutsideClick(e),e.target.closest("#checkoutPopupElement")||this.checkoutPopup.handleOutsideClick(e),e.target.closest("#loginPopupElement")||this.loginPopup.handleOutsideClick(e),e.target.closest("#serverPopupElement")||this.serverPopup.handleOutsideClick(e)}redirectUser(e){this.#g.send(JSON.stringify({type:"redirectUser",target:e}))}fillProductInfo(e){const t=this.getProductById(e.id,!0);return t?(e.size&&(t.size=t.sizes[e.size],t.price=t.size.price),t):{name:"Product Not Found",size:{name:"",size:""},price:0}}get cart(){return this.#m}get lang(){return this.#h}set lang(e){if(2!==e.length)throw new Error("Invalid language code");(e=e.toLowerCase())!==this.#h&&(this.#h=e,this.handleChangeLanguage())}get sessionId(){return this.#p}set user(e){this.#d=e,this.windows.forEach((e=>e.handleUserChange(this.#d)))}get user(){return this.#d}get menu(){return this.#e}get allowUnlock(){return this.#u}get supportedLanguages(){return this.#f}get allowPopup(){return!1===this.serverPopup.visible}}},276:(e,t,i)=>{i.a(e,(async(e,t)=>{try{const e=new(i(934).Z);try{await e.setup()}catch(e){console.warn(e)}t()}catch(e){t(e)}}),1)}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return s[e](i,i.exports,o),i.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",i="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},o.a=(s,r,o)=>{var a;o&&((a=[]).d=-1);var l,c,h,d=new Set,u=s.exports,m=new Promise(((e,t)=>{h=t,c=e}));m[t]=u,m[e]=e=>(a&&e(a),d.forEach(e),m.catch((e=>{}))),s.exports=m,r((s=>{var r;l=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var r=[];r.d=0,s.then((e=>{o[t]=e,n(r)}),(e=>{o[i]=e,n(r)}));var o={};return o[e]=e=>e(r),o}}var a={};return a[e]=e=>{},a[t]=s,a})))(s);var o=()=>l.map((e=>{if(e[i])throw e[i];return e[t]})),c=new Promise((t=>{(r=()=>t(o)).r=0;var i=e=>e!==a&&!d.has(e)&&(d.add(e),e&&!e.d&&(r.r++,e.push(r)));l.map((t=>t[e](i)))}));return r.r?c:o()}),(e=>(e?h(m[i]=e):c(u),n(a)))),a&&a.d<0&&(a.d=0)},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o(276)})();